(function(){$.fn.extend({mgJpegmask:function(e){return e=e||"_mask",$(this).each(function(){if(window.CanvasRenderingContext2D){var t=$(this),n=$(this)[0];t.one("load",function(){t.css("display","none");var r=n.src,i=r.replace(/(.*)\.jpg$/,"$1"+e+".png"),s=document.createElement("img");s.src=i;var o={h:t.attr("height"),w:t.attr("width")};s.onload=function(){var e=$("<canvas />");e.insertAfter(t);var r=e[0];r.width=o.w,r.height=o.h;var i,u,a,f,l=0,c=o.w*o.h;i=r.getContext("2d"),i.clearRect(0,0,o.w,o.h),i.drawImage(s,0,0),a=i.getImageData(0,0,o.w,o.h),u=r.getContext("2d"),u.clearRect(0,0,o.w,o.h),u.drawImage(n,0,0),f=u.getImageData(0,0,o.w,o.h);for(;l<c;l+=1)f.data[4*l+3]=255-a.data[4*l];u.putImageData(f,0,0)}})}else $(this).attr("src",$(this).attr("src").replace(/(.*)\.jpg$/,"$1.png"))}),this}})})(jQuery);